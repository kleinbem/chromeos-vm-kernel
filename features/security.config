# Kernel Security Hardening Profile (SELinux Version)

# --- Memory Safety & Compiler Hardening ---
CONFIG_STACKPROTECTOR=y
CONFIG_STACKPROTECTOR_STRONG=y
CONFIG_INIT_ON_ALLOC_DEFAULT_ON=y
CONFIG_INIT_ON_FREE_DEFAULT_ON=y
CONFIG_PAGE_POISONING=y

# --- Attack Mitigation (Spectre/Meltdown) ---
CONFIG_RETPOLINE=y

# --- Mandatory Access Control (SELinux) ---
CONFIG_SECURITY_SELINUX=y
CONFIG_DEFAULT_SECURITY_SELINUX=y
CONFIG_SECURITY_SELINUX_POLICYDB_VERSION_MAX=y
CONFIG_AUDIT=y
CONFIG_AUDITSYSCALL=y

# 5. Kernel Lockdown
CONFIG_SECURITY_LOCKDOWN_LSM=y
CONFIG_LOCK_DOWN_KERNEL_FORCE_INTEGRITY=y

# 6. Attack Surface Reduction
CONFIG_DEVMEM=n 
CONFIG_DEVKMEM=n

# 7. Module Integrity (Forces signatures on external drivers)
CONFIG_MODULE_SIG_FORCE=y
CONFIG_MODULE_SIG_ALL=y
